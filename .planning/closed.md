## 조치된 이슈


### 변경 감지
1) 변경 감지 로직 동작 안함 - [x]
    - '폴더 추가' 버튼으로 인덱싱 완료 후 해당 폴더에 파일을 추가/삭제해도 변경 감지 로직이 동작하지 않음.
        --> 해당 폴더 내 삭제된 파일도 여전히 검색되고, 수정하거나 새로 추가한 파일은 변경된 내용으로 검색되지 않음.
    - '파일 - 설정 - 폴더 관리' 메뉴에서 추가된 폴더 목록이 확인되지 않음
    
2) 파일 감지 조건 수정
    - [x] 실제 데이터 수정이 일어난 경우에만 큐에 추가되도록 수정. 현재 단순 파일 엑세스 만으로도 큐에 추가되서 태그 중복 생성 등 불필요한 작업이 발생 함.
    - [x] 신규 생성 감지 이후 첫 번째 엑세스(단순 read) 에 경우에도 큐에 추가 되고있음. 단순 read에 대해서는 큐에 추가되지 않도록 수정 필요.


### GUI
1) '폴더 추가' 버튼을 눌러 인덱싱 시작시 GUI가 블로킹 됨 - [x] 
    - 인덱싱 작업은 백그라운드로 처리하고 GUI는 계속 응답 가능한 상태로 두어 인덱싱과 동시에 검색을 수행 할 수 있어야 함.
    - 하단에 상태표시줄을 하나 더 두어 인덱싱 작업 상황을 표시해야함. (진행 중임을 알 수 있는 간단한 애니메이션, 현재 작업중인 파일, 진행률, 남은 시간등)

2) 최초 실행 시 다운로드, 문서, 사진 폴더는 자동 인덱싱 되어야 함. 단, 인덱싱 수행 전 알림창을 띄워 화면에서 '예', '아니오' 버튼을 제공해야하고, '예' 버튼을 눌렀을 시에만 해당 폴더들에 대한 인덱싱을 시작해야함. - [x] 

3) 설정메뉴에 들어가는 방법이 안보임. - [x]
    - 상단에 메뉴바가 있던가 사이드 메뉴바를 만들던가 해서 설정메뉴에 들어갈 수 있어야 함.
    - 설정 메뉴를 통해 등록된 폴더, 태그, LLM 설정 등을 들어갈 수 있어야 함.

4) 인덱싱이 완료된 파일에 대해 검색이 안됨 - [x]
    - 인덱싱 완료 후 파일을 검색해도 아무 것도 나오지 않음.
    - 벡터 데이터베이스 관련된 파일 및 데이터가 생성되지 않는 것으로 보임.
    - SQLite DB에는 인덱싱 완료된 건에 대해 레코드 추가 되는 것을 확인하였음.

5) 추가 다이얼로그 창 등의 가시성 문제 - [x]
    - 메인 윈도우는 괜찮은데 그 외 창의 경우 배경 윈도우는 하얀색인데 글씨도 하얀색이라 가시성이 좋지 않음. 통일성 있는 테마 적용이 필요함.

6) 폴더 추가 기능 로직 동작 안함 - [x]
    - '파일 - 설정 - 폴더 관리' 메뉴의 '추가' 버튼을 누르면 폴더 선택 창이 뜨면서 폴더를 선택할 수 있어야 하나 버튼으로 눌러도 동작 없음.




## 기능 추가/개선

### 검색 결과 UI 개선
1) 검색 결과의 view 방식을 두가지로 제공 (목록형, 아이콘형) 하도록 개선. - [x]
    - 검색 결과 출력창 바로 위에 view 선택 아이콘 추가하여 검색 결과의 보기 방식을 변경할 수 있도록 함.
    - 목록형: 아이콘, 파일명, 수정일, 태그, 경로 등을 한줄로 표시.(윈도우 파일 탐색기의 '자세히' 모드와 유사하게)
    - 아이콘형: 파일 아이콘과 파일명을 표시. 아이콘을 격자형으로 배치.(윈도우 파일 탐색기의 '보통 아이콘' 모드와 유사하게) 

2) 검색 결과의 각 항목을 1번 클릭(더블클릭 아님) 하는 경우 우측에 파일 세부 정보 창 출력 - [x]
    - 세부 정보에는 아이콘, 파일명, 파일 경로, 수정일, 태그 목록 출력 필수.

3) 검색 결과의 각 항목을 더블 클릭 하는 경우 해당 파일 실행(windows 시스템의 기본 연결 프로그램 설정 사용) - [x]

4) 검색 결과의 각 항목에 마우스 커서를 올릴 경우 보기 방식에 따라 hover 이벤트 처리 - [x]
    - 목록형: 해당 항목의 오른쪽 끝에 아이콘 두개 생성.
        - 폴더 아이콘 : 해당 파일이 속한 폴더를 윈도우 탐색기에서 열기
        - 점 세개 아이콘 : 해당 파일에 대한 추가 메뉴 표시. (메뉴 내용: 태그 관리, 파일 삭제, 파일 정보 보기)
    - 아이콘형: 배경색이 변하면서 하이라이팅 효과를 추가하고 해당 항목의 아래에 아이콘 두개 생성.
        - 폴더 아이콘 : 해당 파일이 속한 폴더를 윈도우 탐색기에서 열기
        - 점 세개 아이콘 : 해당 파일에 대한 추가 메뉴 표시. (메뉴 내용: 태그 관리, 파일 삭제, 파일 정보 보기)

5) 검색 결과에 태그 표시 기능 추가
- [x] '목록형 보기' 모드 일 때에만 검색결과 창에 태그 표시(그 외 보기 모드에서는 태그 표시 안함.)
    - [x] 표시는 칩(Chip) 형태로 표시 : 태그 관리 메뉴에서 보여주는 칩과 동일한 스타일 적용.
    ** (주의) DB에 저장된 색상도 연동되어야 함
    - [x] 칩을 클릭하면 태그 입력창에 자동으로 해당 태그가 추가됨.
    - [x] 출력할 태그 칩 개수는 가로 창 길에 따라 반응형으로 조절하되 최대는 6개까지로 제한. 6개 이상일 경우 '...'으로 표시
- [x] (bug) 검색 결과로 표시할 파일 갯수가 적은 경우 적은 파일 갯수로 검색결과 공간을 채우려고 하면서 과도한 공백이 발생함. 위아래방향 길이는 고정하고 좌우방향로만 반응형으로 배치하도록 수정 필요.

#### 아이콘 보기 모드 UX 개선
- [x] 아이콘형 보기 모드가 현재 아이콘만 세로로 깔았을 뿐인 목록형 보기 모드와 다를 바가 없음. 아이콘형 보기에 맞게 레이아웃 변경
    - [x] 파일명이 아이콘 바로 아래에 가운데에 표기되도록 수정
    - [x] 각 항목은 격자형 레이아웃으로 표시되어야 하며, 창 사이즈에 따라 반응형으로 그리드가 조절 되어야 함.
        -> 예를 들어 검색 결과가 9개이고 창 사이즈가 충분할 때 3x3 격자로 표시되고, 창 사이즈가 줄어들면 2x5 격자로 표시되는 식으로 유연하게 조절되어야 함.


### 검색 창 UI 개선
1) 메인 검색어 입력창 왼쪽에 검색 모드 선택을 위한 드롭박스 추가(디폴트는 '통합 검색') - [x]
    - 통합 검색
    - 텍스트 검색
    - 이미지 검색
    - 태그 검색
2) 메인 검색어 입력창 오른쪽에 확장자 필터 입력창 추가(디폴트는 공백, 공백일 경우 모든 확장자 검색) - [x]
    - 콤마(,)로 구분하여 여러 확장자를 입력할 수 있음. 예: txt, md, py, pdf, docx
    - 입력창 우측에 'x' 버튼을 추가하여 입력된 확장자 필터를 초기화 할 수 있어야 함.

3) 보기모드 선택 버튼 개선
    - [x] 목록형 / 아이콘형 두개의 보기 모드 변경 버튼을 아이콘으로 변경
    - [x] 배치를 검색 모드 드롭다운 아래, 검색 결과창 위 좌측 상단에 배치
    - [x] 어떤 모드인지 직관적으로 알 수 있는 디자인의 아이콘 이미지는 직접 생성해서 적용.

4) 대기열 버튼 / 팝업 개선
    - [x] 대기열 혹은 '큐'를 직관적으로 이해하기 쉬운 아이콘 이미지를 생성해서 해당 아이콘을 버튼으로 교체.
    - [x] 대기열에 몇개 있는지는 모바일 앱의 알림뱃지 처럼 버튼 우측 상단에 숫자로 표시.
    - [x] 대기열 버튼 시 나타나는 팝업에는 제목 표시줄 제거.(닫기버튼 만 보이도록 개선)

5) 검색 결과에 표시되는 파일 아이콘이 시스템의 기본 아이콘이 출력 되도록 수정 - [x]

6) 검색 결과 창 이벤트 수정
    - [x] 현재 마우스 hover 이벤트로 나타나는 처리를 클릭 이벤트로 변경. (배경 하이라이트, 파일 위치 열기버튼, 상세 작업 버튼)
        -> hover 이벤트는 삭제하고 기존의 hover 이벤트 시 발생 하는 동작은 클릭(더블클릭 아님) 이벤트로만 동작하도록 수정.
    - [x] 상세 작업 버튼(점 세개) 클릭 시 나타나는 메뉴는 우클릭 이벤트에도 발생하도록 수정.
        - [x] '태그 관리' 메뉴만 남고 나머지 두 개 메뉴가 이유없이 삭제되어있음. 기존에 있던 메뉴 복구 요망.
        - [x] 아이콘 보기 버튼이 있던 레이아웃 영역과 메인 윈도우 최하단 상태 메시지 표시하던 레이아웃 영역의 비율이 기존과 다르게 과도하게 커졌음. 기존 비율로 복구 요망.

7) 태그 관리 메뉴 개선
- [x] 검색 결과의 '컨텍스트 메뉴 - 태그 관리' 메뉴에서 보여주는 태그 목록에도 칩 스타일 적용.
    - [x] 칩의 배경색은 DB 색깔과 연동되도록 할 것.
- [x] 하단에 태그 검색용 입력창 추가하여 입력된 문자를 포함하는 태그만 보여주도록 할 것.(like 검색)


### LLM 어댑터 개선
- [x] OpenAI 어댑터의 경우 base_url을 설정할 수 있도록 수정(설정 메뉴의 UI 수정 포함)
- [x] Ollama 어댑터의 경우 base_url을 설정할 수 있도록 수정(설정 메뉴의 UI 수정 포함)

### 파일 인덱싱 기능 개선
1) 기본적으로 watchdog 감지 속도와 임베딩을 포함한 인덱싱 속도가 매우 느리므로 인덱싱 처리 방식을 단순 순차 처리가 아닌 우선순위 큐를 인덱싱 작업 큐로 사용하고, 처리 목록을 직접적인 파일 경로나 파일 객체가 아닌 큐아이템이라는 단위로 추상화하여 인덱싱을 처리하는 것을 제안 - [x]
    (큐 처리 방식 컨셉)
    - '파일 - 설정 - 폴더 관리'에서 신규 폴더를 추가하거나 기존 폴더 내 신규 파일이 감지된 경우에는 작업 큐에 'update' 상태의 큐 아이템을 추가
    - '파일 - 설정 - 폴더 관리'에서 대상 폴더를 삭제하거나 기존 폴더 내 삭제된 파일이 감지된 경우에는 작업 큐에 'delete' 상태의 큐 아이템을 추가
    - 기본적으로 'delete'상태 아이템이 'update'상태 아이템 보다 우선순위가 높음.
    - 동일한 파일에 대해 같은 상태의 큐 아이템이 여러 개가 큐에 쌓여있을 경우 가장 마지막에 추가된 큐 아이템만 남기고 나머지는 삭제.
    - 'update' 상태의 아이템을 처리하는 도중 같은 파일에 대한 'delete' 상태의 아이템이 추가될 경우 'update' 상태의 아이템을 처리 중단하고 'delete' 상태의 아이템을 처리.
    - 'update' 상태의 아이템이 큐에 대기 중 같은 파일에 대한 'delete' 상태의 아이템이 추가될 경우 'update' 상태의 아이템을 삭제.
    
    - [x] 누르면 추가 창이 뜨면서 현재 큐에 쌓여있는 큐 아이템 목록을 볼 수 있어야 함.
    - [x] 현재 처리 중인 아이템에는 간단한 스피너 애니메이션과 함께 처리 중임을 표시.
    - [x] 처리 완료 (Priority Queue 및 Worker Thread 구조 적용, UI 상태 표시 추가됨)
    - [x] 추가 보완: 폴더 추가 시 초기 스캔 로직도 비동기 큐 처리로 변경하여 UI 블로킹 완전 제거.

### 태그 기능 개선
1) 태그 자동생성 기능 외부화
    - [x] 현재 설정메뉴 UI만 구현되어있고 연결된 백엔드 로직이 없거나 동작하지 않는 상태로 보임. 저장해도 config.json에 변화 없고, 설정 저장 후 신규 파일 감지시 태그 생성 적용도 안되는 것으로 보임.
    
2) 태그 관리 기능 구현
    - [x] 검색결과 목록에서 점 세개 버튼 눌러서 '태그 관리' 메뉴를 클릭해도 아무 반응 없음.
    - [x] '파일 - 설정 - 태그 관리' 메뉴에 들어가면 태그를 추가/수정하거나 삭제하는 기능에 대한 UI 버튼도 미구현.
    2-1) 태그 저장 버그
    - [x] DB에 태그 저장이 안되고 있음
        - 검색 결과 항목 '우클릭 - 태그 관리' 선택시 태그관리 대화상자가 뜨는 대신 오류 발생.
        - 어쩌다 대화 상자가 떠서 태그를 추가해도 DB에 저장이 안됨.(file_tags 테이블에 변동사항 없음)


3) 태그 검색 전반 개선
- [x] 멀티 태그 검색이 가능하도록 개선
    (세부사항)
    1-1) 검색창 UI 변경
    - [x] 메인 검색창 드롭다운에서 '태그 검색'을 제거하고 별도의 태그검색용 레이아웃을 기존 검색어 입력창 바로 아래에 추가
    태그 검색 UI 레이아웃은 다음을 포함해야 함. 
        - [x] 태그 필터조건 드롭다운(AND, OR)
        - [x] 태그 입력창
    - [x] 태그 입력 창에 다음 로직 및 UI 서식 적용.
        - [x] 태그 입력창에 무언가 입력하면 DB의 tag 테이블에서 해당 키워드가 포함된 태그를 찾아서(like 검색) 연관 태그 리스트를 출력하고, 사용자가 해당 리스트에서 태그를 선택하면 해당 태그가 태그 입력창에 자동 추가될 수있도록 함.
        - [x] 입력된 태그는 tagify와 유사한 느낌의 UI 서식을 적용하여 표시.
            - [x] 태그 입력창에서의 입력된 태그는 각 태그 별로 레이블(실제 태그), 배경색, 삭제('x') 버튼으로 구성되어 있어야 함.
            - [x] 태그 별로 배경색은 사용자가 변경 관리할 수 있는 구조로 구성/저장되어 있어야 함 
                --> '1-2) 태그 관리 설정 개선' 항목과도 연관됨.
        - [x] 태그 입력창에 입력된 태그는 시각적으로도 'x' 버튼이 있어 마우스로도 삭제가 가능해야 하며, 키보드로 backspace나 delete키 입력 시에도 해당 커서 위치에 있는 태그가 한번에 삭제되어야 함.
        - [x] 태그 입력창에서도 enter 키 입력시 동일하게 검색 함수가 호출되어야 함

    1-2) 태그 관리 설정 개선
    - [x] '파일 - 설정 - 태그 관리' 메뉴에서 보이는 태그 리스트에도 1-1에서 적용한 것과 비슷한 형태의 서식 적용. 단 'x'버튼은 없어도 됨(기존의 '삭제' 버튼을 그대로 사용할 예정.)
    - [x] '파일 - 설정 - 태그 관리' 메뉴에 들어왔을 때 상단에 태그 검색창을 하나 추가하여 등록된 태그 필터링이 가능해야 함.
    - [x] '파일 - 설정 - 태그 관리' 메뉴 하단에 '색상 변경' 버튼을 추가
        - [x] 해당 버튼 클릭시 색상 변경을 위한 커스텀 컬러피커를 띄우고, 사용자가 선택한 색상을 DB에 저장하고, '파일 - 설정 - 태그 관리' 메뉴에서 보이는 태그 리스트의 배경색을 변경해야 함.
        - [x] 해당 메뉴에서 저장 완료 시 메인 윈도우 내 태그 입력 창에도 변경된 색상이 즉시 반영되어야 함.

    
    1-3) 태그 검색을 포함한 검색 로직 개선
    - [x] UX적으로 보았을 때 기존의 확장자 필터에 입력이 있을 경우와 비슷하게 태그 입력창에 입력이 있는 경우에는 검색 결과에서입력된 태그 검색 조건에 따른 필터링이 이루어져야 함.
        - [x] 필터조건 드롭다운에 선택된 항목 (AND, OR)에 따라 적절하게 필터링 되어야 함
            - AND 선택시 입력된 모든 태그가 포함된 파일만 결과로 출력
            - OR 선택시 입력된 태그가 중 하나라도 포함된 파일들을 결과로 출력
    - [x] 검색어 입력은 없고 태그 입력만 있는 경우에는 태그 조건에 걸리는 모든 파일이 검색 결과로 출력 되어야 함.


### 검색창 UI 개선
    

### 파일 상세 패널(DetailPane) UI 개선
- [x] 검색 결과에서 항목 클릭 했을 때 DetailPane의 상단에도 선택한 항목의 아이콘으로 변경되도록 수정.
- [x] DetailPane의 사이즈 조절 기능 추가. 현재는 고정된 사이즈로 표시되어 창이 좁을 때 검색 결과 화면이 상대적으로 좁아보임.
    - [x] 마우스 hover시에 사이즈 조절이 가능한 것처럼 커서가 변하긴 하나 실제로는 사이즈 조절이 안됨. 실제로 가로축 사이즈조절이 되어야 함
- [x] DetailPane의 표시 토글 기능 추가(현대적인 사이드메뉴 바 디자인에서 많이 사용하는 것처럼 접었다 폈다 느낌으로 구현)

### 대기열 대화상자(QueueDialog) UI 개선
- [x] 제목 표시줄을 없애면서 대기열 버튼 클릭시 팝업되는 대화상자의 이동 및 크기 조절이 불가능하게 되었음. 이동 및 크기 조절이가능하도록 수정.
- [x] 대화상자 내 주요 레이블 모두 한글로 변경
    -> "Indexing Queue" -> "대기열"
    -> "Pending Tasks:" -> "대기 중인 작업:"
    -> "Refresh" -> "새로고침"
    -> "Idle" -> "현재 작업 없음"
    -> "Close" -> "닫기"
    * 나중에 다국어 지원이 용이하도록 기존 영어 레이블을 재사용이 용이하도록 백업(백업 형식은 PySide에서 적용하기 가장 편한방식으로 자유롭게 해도 됨).
- [x] (new) 대화상자 좌상단에(대화상자 레이블 부분) 원래 표시되지 않던 스피너 애니메이션이 상시 출현함. 삭제 필요.
- [x] (new) 대화상자 우상단의 닫기버튼('X' 버튼)이 마우스 커서를 올리기 전에는 있는지 없는지 구분이 안됨. 하얀색으로 'X'가보이도록 수정

### 태그 입력창 가시성 개선
- [x] 태그 입력창 태그 UI(chip) 가시성 개선.
    - 태그 관리 메뉴에서 보이는 것과 다르게 글자 뒤에 배경색이 적용되지 않은 영역 존재.
    - X 버튼도 동일하며, 'X' 표시가 안보임. 태그명 글자 색과 동일한 색상 적용 필요.
    - 스타일 시트와 충돌나는 부분이 없는지 확인

- [x] 태그 입력 자동완성 리스트 가시성 개선
    - 흰 바탕에 하얀색 글씨라서 가시성이 좋지 않음. 현재 전체적으로 다크 모드 느낌으로 구현되어있으므로 일관성 있는 디자인으로 가시성 개선 필요.

### 스타일 시트 관리 구조 리팩토링
- 향후 UI 스타일 관리 용이성 확보를 위한 사전 리팩토링 수행. 스타일 시트를 ui/resources/styles 폴더 내 qss 파일로 관리.
    1) ui/resources/styles/themes : 전역 기본 스타일 정보. 이 프로그램 내 모든 UI 컴포넌트는 기본적으로 이 스타일을 적용해야함.
    2) ui/resources/styles/components : UI 컴포넌트별 기본 스타일 정보.

    (스타일 시트 관련 폴더 구조)

    ```
    semanticfilesearcher/
    ...
    ├──ui
    │  └──resources
    │     └──styles
    │        └──themes
    │        └──components
    ...
    ```
    - [x] ui/resources/styles/themes 폴더 내로 현재 style.qss 파일 이동 후 본 프로그램 내 참조 경로도 수정.
    - [x] UI 관련 소스코드 내에 개별적으로 setStyleSheet() 안에 하드 코딩된 스타일 정보는 전부 별도 qss 파일로 빼서 참조하도록 하고, 소스코드 내에 스타일 정보가 하드코딩되지 않도록 수정.
        * (중요) 개별적인 컴포넌트 파일 내에서 사용되는 qss는 ui/resources/styles/themes 내 qss에 의한 스타일보다 적용 우선도가 높아야 함.
    - [x] 태그 칩과 관련된 스타일은 글로벌 테마와 상관 없이 항상 같은 스타일을 적용할 것이므로 별도 qss 파일로 분리.

### UI 테마 관리 기능 추가
- [x] 라이트 모드용 스타일 생성
- [x] 라이트 모드용 아이콘 생성
    - [x] sidebar_toggle 아이콘은 sidebar_toggle_white.svg에서 색만 반전시킨 것을 신규 생성
    - [x] 그 외 아이콘은 기존의 아이콘 사용 ('_white'가 없는 파일들 사용)
- [x] 상단 메뉴에 '편집' 메뉴 추가
- [x] '편집' 메뉴에 '테마' 하위 메뉴 추가
- [x] '테마' 하위 메뉴에 '다크 모드', '라이트 모드' 추가
- [x] '다크 모드', '라이트 모드' 클릭 시 테마 변경


### 구글 ai 패키지 이슈
- [x] google-generativeai 패키지에서 google-genai로 교체해야함.